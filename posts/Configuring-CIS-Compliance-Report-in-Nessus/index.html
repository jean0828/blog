<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="How to Configure CIS Compliance Report in Nessus" /><meta property="og:locale" content="en" /><meta name="description" content="Vulnerability scanner is a system designed to assess computers, networks or applications for known weaknesses. This system is a key part in any security program because we can automate those scans and centralize those results for better analysis in remediation. For that reason, we’re going to install and configure Nessus Manager to check CIS compliance against a Windows Server. Installation Nessus Clic in try in the following web page: https://www.tenable.com/products/nessus to get an email for installation guide Once you have the email, you’ll active the account and in My Trials section Download nessus manager package. In this case, it will be installed in Kali Linux OS update Kali Linux 1 apt update install Nessus package with the follwing command: 1 dpkg -i Nessus-&lt;version number&gt;-debian6_amd64.deb start and enable Nessus service with those commands: 1 2 systemctl start nessusd.service systemctl enable nessusd.service Configuring nessus. After the Nessus service starts, use a web browser to navigate to the Nessus Web Interface at: https://localhost:8834/. copy and paste the code obtained in the step 2 Then, create an username and password. for this case the username is nessus_adm and the pass is 1QazxsW@ Next, Nessus will take some minutes to initialize its plugins. Creating a scan Now, that we have all installed, we can create a compliance scan to see how our good or bad is a Windows server according to CIS. For this example, we have another Windows server 2016 and it will be tested with CIS L1. To do that, we can do the following steps: create a compliance scan select target (IP Address) provide credentials select the benchmark Now, we can save and launch the scan. Creating a custom baseline based on CIS it’s important to know, that our server doesn’t have any baseline, it only has all configurations by default. Therefore, the server only has a 84 items passed. However, we can create a custom baseline based on CIS benchmark because an organization can focus on specific items according to the risk that they want to take it. To ilustrate this situation, imagine that our company only has as a baseline a password policy and only wants to see those configurations:. Account lockout duration Enforce password history Interactive logon: Machine account lockout threshold Maximum password age Minimum password age Minimum password length Password must meet complexity requirement Reset lockout counter after Network security: Force logoff when logon hours expire In this situation, we have to download the CIS bechmark for Windows server 2016 here: https://www.tenable.com/audits/ after download the file, we can edit with visual studio or any text editor. the CIS benchmark file looks like this: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 &lt;custom_item&gt; type : LOCKOUT_POLICY description : &quot;Account lockout duration&quot; info : &quot;Account lockout duration This security setting determines the number of minutes a locked-out account remains locked out before automatically becoming unlocked. The available range is from 0 minutes through 99,999 minutes. If you set the account lockout duration to 0, the account will be locked out until an administrator explicitly unlocks it. If an account lockout threshold is defined, the account lockout duration must be greater than or equal to the reset time. Default: None, because this policy setting only has meaning when an Account lockout threshold is specified.&quot; solution : &quot;Policy Path: Account Policies\Account Lockout Policy Policy Name: Account lockout duration&quot; reference : &quot;800-171|3.1.8,800-53|AC-7a.,CN-L3|8.1.4.1(b),CSCv6|16.7,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2&quot; see_also : &quot;https://blogs.technet.microsoft.com/secguide/2016/10/17/security-baseline-for-windows-10-v1607-anniversary-edition-and-windows-server-2016/&quot; value_type : TIME_MINUTE value_data : [15..MAX] lockout_policy : LOCKOUT_DURATION &lt;/custom_item&gt; after modifying the file, we can edit the scan in Nessus and see the new results. it can be seen that the compliance report is according to the items that we want. Furthermore, if those items are configured, it will show in the next scan as a PASSED status. if we see the history we see that we have improved the compliance report, remediating some items. Before: After Finally, if there is no budget to purchase a vulnerability tool like Nessus, we can explore open source tools like this: https://github.com/0x6d69636b/windows_hardening. Then, we can create a central repository to save all the outputs and finally trying to create a dashboard with the results." /><meta property="og:description" content="Vulnerability scanner is a system designed to assess computers, networks or applications for known weaknesses. This system is a key part in any security program because we can automate those scans and centralize those results for better analysis in remediation. For that reason, we’re going to install and configure Nessus Manager to check CIS compliance against a Windows Server. Installation Nessus Clic in try in the following web page: https://www.tenable.com/products/nessus to get an email for installation guide Once you have the email, you’ll active the account and in My Trials section Download nessus manager package. In this case, it will be installed in Kali Linux OS update Kali Linux 1 apt update install Nessus package with the follwing command: 1 dpkg -i Nessus-&lt;version number&gt;-debian6_amd64.deb start and enable Nessus service with those commands: 1 2 systemctl start nessusd.service systemctl enable nessusd.service Configuring nessus. After the Nessus service starts, use a web browser to navigate to the Nessus Web Interface at: https://localhost:8834/. copy and paste the code obtained in the step 2 Then, create an username and password. for this case the username is nessus_adm and the pass is 1QazxsW@ Next, Nessus will take some minutes to initialize its plugins. Creating a scan Now, that we have all installed, we can create a compliance scan to see how our good or bad is a Windows server according to CIS. For this example, we have another Windows server 2016 and it will be tested with CIS L1. To do that, we can do the following steps: create a compliance scan select target (IP Address) provide credentials select the benchmark Now, we can save and launch the scan. Creating a custom baseline based on CIS it’s important to know, that our server doesn’t have any baseline, it only has all configurations by default. Therefore, the server only has a 84 items passed. However, we can create a custom baseline based on CIS benchmark because an organization can focus on specific items according to the risk that they want to take it. To ilustrate this situation, imagine that our company only has as a baseline a password policy and only wants to see those configurations:. Account lockout duration Enforce password history Interactive logon: Machine account lockout threshold Maximum password age Minimum password age Minimum password length Password must meet complexity requirement Reset lockout counter after Network security: Force logoff when logon hours expire In this situation, we have to download the CIS bechmark for Windows server 2016 here: https://www.tenable.com/audits/ after download the file, we can edit with visual studio or any text editor. the CIS benchmark file looks like this: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 &lt;custom_item&gt; type : LOCKOUT_POLICY description : &quot;Account lockout duration&quot; info : &quot;Account lockout duration This security setting determines the number of minutes a locked-out account remains locked out before automatically becoming unlocked. The available range is from 0 minutes through 99,999 minutes. If you set the account lockout duration to 0, the account will be locked out until an administrator explicitly unlocks it. If an account lockout threshold is defined, the account lockout duration must be greater than or equal to the reset time. Default: None, because this policy setting only has meaning when an Account lockout threshold is specified.&quot; solution : &quot;Policy Path: Account Policies\Account Lockout Policy Policy Name: Account lockout duration&quot; reference : &quot;800-171|3.1.8,800-53|AC-7a.,CN-L3|8.1.4.1(b),CSCv6|16.7,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2&quot; see_also : &quot;https://blogs.technet.microsoft.com/secguide/2016/10/17/security-baseline-for-windows-10-v1607-anniversary-edition-and-windows-server-2016/&quot; value_type : TIME_MINUTE value_data : [15..MAX] lockout_policy : LOCKOUT_DURATION &lt;/custom_item&gt; after modifying the file, we can edit the scan in Nessus and see the new results. it can be seen that the compliance report is according to the items that we want. Furthermore, if those items are configured, it will show in the next scan as a PASSED status. if we see the history we see that we have improved the compliance report, remediating some items. Before: After Finally, if there is no budget to purchase a vulnerability tool like Nessus, we can explore open source tools like this: https://github.com/0x6d69636b/windows_hardening. Then, we can create a central repository to save all the outputs and finally trying to create a dashboard with the results." /><link rel="canonical" href="https://jean0828.github.io/blog/posts/Configuring-CIS-Compliance-Report-in-Nessus/" /><meta property="og:url" content="https://jean0828.github.io/blog/posts/Configuring-CIS-Compliance-Report-in-Nessus/" /><meta property="og:site_name" content="Unf0rG1v3n" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-23T04:50:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="How to Configure CIS Compliance Report in Nessus" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-23T04:50:00+00:00","datePublished":"2022-07-23T04:50:00+00:00","description":"Vulnerability scanner is a system designed to assess computers, networks or applications for known weaknesses. This system is a key part in any security program because we can automate those scans and centralize those results for better analysis in remediation. For that reason, we’re going to install and configure Nessus Manager to check CIS compliance against a Windows Server. Installation Nessus Clic in try in the following web page: https://www.tenable.com/products/nessus to get an email for installation guide Once you have the email, you’ll active the account and in My Trials section Download nessus manager package. In this case, it will be installed in Kali Linux OS update Kali Linux 1 apt update install Nessus package with the follwing command: 1 dpkg -i Nessus-&lt;version number&gt;-debian6_amd64.deb start and enable Nessus service with those commands: 1 2 systemctl start nessusd.service systemctl enable nessusd.service Configuring nessus. After the Nessus service starts, use a web browser to navigate to the Nessus Web Interface at: https://localhost:8834/. copy and paste the code obtained in the step 2 Then, create an username and password. for this case the username is nessus_adm and the pass is 1QazxsW@ Next, Nessus will take some minutes to initialize its plugins. Creating a scan Now, that we have all installed, we can create a compliance scan to see how our good or bad is a Windows server according to CIS. For this example, we have another Windows server 2016 and it will be tested with CIS L1. To do that, we can do the following steps: create a compliance scan select target (IP Address) provide credentials select the benchmark Now, we can save and launch the scan. Creating a custom baseline based on CIS it’s important to know, that our server doesn’t have any baseline, it only has all configurations by default. Therefore, the server only has a 84 items passed. However, we can create a custom baseline based on CIS benchmark because an organization can focus on specific items according to the risk that they want to take it. To ilustrate this situation, imagine that our company only has as a baseline a password policy and only wants to see those configurations:. Account lockout duration Enforce password history Interactive logon: Machine account lockout threshold Maximum password age Minimum password age Minimum password length Password must meet complexity requirement Reset lockout counter after Network security: Force logoff when logon hours expire In this situation, we have to download the CIS bechmark for Windows server 2016 here: https://www.tenable.com/audits/ after download the file, we can edit with visual studio or any text editor. the CIS benchmark file looks like this: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 &lt;custom_item&gt; type : LOCKOUT_POLICY description : &quot;Account lockout duration&quot; info : &quot;Account lockout duration This security setting determines the number of minutes a locked-out account remains locked out before automatically becoming unlocked. The available range is from 0 minutes through 99,999 minutes. If you set the account lockout duration to 0, the account will be locked out until an administrator explicitly unlocks it. If an account lockout threshold is defined, the account lockout duration must be greater than or equal to the reset time. Default: None, because this policy setting only has meaning when an Account lockout threshold is specified.&quot; solution : &quot;Policy Path: Account Policies\\Account Lockout Policy Policy Name: Account lockout duration&quot; reference : &quot;800-171|3.1.8,800-53|AC-7a.,CN-L3|8.1.4.1(b),CSCv6|16.7,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2&quot; see_also : &quot;https://blogs.technet.microsoft.com/secguide/2016/10/17/security-baseline-for-windows-10-v1607-anniversary-edition-and-windows-server-2016/&quot; value_type : TIME_MINUTE value_data : [15..MAX] lockout_policy : LOCKOUT_DURATION &lt;/custom_item&gt; after modifying the file, we can edit the scan in Nessus and see the new results. it can be seen that the compliance report is according to the items that we want. Furthermore, if those items are configured, it will show in the next scan as a PASSED status. if we see the history we see that we have improved the compliance report, remediating some items. Before: After Finally, if there is no budget to purchase a vulnerability tool like Nessus, we can explore open source tools like this: https://github.com/0x6d69636b/windows_hardening. Then, we can create a central repository to save all the outputs and finally trying to create a dashboard with the results.","headline":"How to Configure CIS Compliance Report in Nessus","mainEntityOfPage":{"@type":"WebPage","@id":"https://jean0828.github.io/blog/posts/Configuring-CIS-Compliance-Report-in-Nessus/"},"url":"https://jean0828.github.io/blog/posts/Configuring-CIS-Compliance-Report-in-Nessus/"}</script><title>How to Configure CIS Compliance Report in Nessus | Unf0rG1v3n</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Unf0rG1v3n"><meta name="application-name" content="Unf0rG1v3n"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/blog/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/blog/" class="mx-auto"> </a></div><div class="site-title"> <a href="/blog/">Unf0rG1v3n</a></div><div class="site-subtitle font-italic">Security engineer</div></div><ul class="w-100"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/jean0828" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['jean.santamaria93','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/blog/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/blog/"> Home </a> </span> <span>How to Configure CIS Compliance Report in Nessus</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>How to Configure CIS Compliance Report in Nessus</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1658551800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 23, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/jean0828">Jean Pierre</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="694 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><p>Vulnerability scanner is a system designed to assess computers, networks or applications for known weaknesses. This system is a key part in any security program because we can automate those scans and centralize those results for better analysis in remediation. For that reason, we’re going to install and configure Nessus Manager to check CIS compliance against a Windows Server.</p><h2 id="installation-nessus"><span class="mr-2">Installation Nessus</span><a href="#installation-nessus" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>Clic in <em>try</em> in the following web page: https://www.tenable.com/products/nessus to get an email for installation guide<li>Once you have the email, you’ll active the account and in <em>My Trials</em> section<li>Download nessus manager package. In this case, it will be installed in Kali Linux OS</ol><p><a href="https://i.imgur.com/4rWTSDZ.png" class="popup img-link "><img data-src="https://i.imgur.com/4rWTSDZ.png" alt="download-nm" class="lazyload" data-proofer-ignore></a></p><ol><li>update Kali Linux</ol><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>apt update
</pre></table></code></div></div><p><a href="https://i.imgur.com/v3iskBb.png" class="popup img-link "><img data-src="https://i.imgur.com/v3iskBb.png" alt="update-kali" class="lazyload" data-proofer-ignore></a></p><ol><li>install Nessus package with the follwing command:</ol><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dpkg -i Nessus-&lt;version number&gt;-debian6_amd64.deb
</pre></table></code></div></div><p><a href="https://i.imgur.com/dlgFDZQ.png" class="popup img-link "><img data-src="https://i.imgur.com/dlgFDZQ.png" alt="install-nessus" class="lazyload" data-proofer-ignore></a></p><ol><li>start and enable Nessus service with those commands:<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>systemctl start nessusd.service
systemctl enable nessusd.service
</pre></table></code></div></div><li>Configuring nessus.</ol><p>After the Nessus service starts, use a web browser to navigate to the Nessus Web Interface at: https://localhost:8834/.</p><p><a href="https://i.imgur.com/xruyBSh.png" class="popup img-link "><img data-src="https://i.imgur.com/xruyBSh.png" alt="web-nessus" class="lazyload" data-proofer-ignore></a></p><p>copy and paste the code obtained in the step 2</p><p><a href="https://i.imgur.com/mopGF2I.png" class="popup img-link "><img data-src="https://i.imgur.com/mopGF2I.png" alt="web-nessus2" class="lazyload" data-proofer-ignore></a></p><p>Then, create an username and password. for this case the username is <em>nessus_adm</em> and the pass is <em>1QazxsW@</em></p><p><a href="https://i.imgur.com/FHPmoXS.png" class="popup img-link "><img data-src="https://i.imgur.com/FHPmoXS.png" alt="web-nessus3" class="lazyload" data-proofer-ignore></a></p><p>Next, Nessus will take some minutes to initialize its plugins.</p><p><a href="https://i.imgur.com/9S2ICeC.png" class="popup img-link "><img data-src="https://i.imgur.com/9S2ICeC.png" alt="web-nessus4" class="lazyload" data-proofer-ignore></a></p><h2 id="creating-a-scan"><span class="mr-2">Creating a scan</span><a href="#creating-a-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now, that we have all installed, we can create a compliance scan to see how our good or bad is a Windows server according to CIS. For this example, we have another Windows server 2016 and it will be tested with CIS L1. To do that, we can do the following steps:</p><ul><li>create a compliance scan<li>select target (IP Address)<li>provide credentials<li>select the benchmark</ul><p><a href="https://i.imgur.com/5fq00lD.png" class="popup img-link "><img data-src="https://i.imgur.com/5fq00lD.png" alt="create" class="lazyload" data-proofer-ignore></a> <a href="https://i.imgur.com/CqKXRA2.png" class="popup img-link "><img data-src="https://i.imgur.com/CqKXRA2.png" alt="target" class="lazyload" data-proofer-ignore></a> <a href="https://i.imgur.com/IScB8SL.png" class="popup img-link "><img data-src="https://i.imgur.com/IScB8SL.png" alt="credential" class="lazyload" data-proofer-ignore></a> <a href="https://i.imgur.com/LZTML5T.png" class="popup img-link "><img data-src="https://i.imgur.com/LZTML5T.png" alt="cis" class="lazyload" data-proofer-ignore></a></p><p>Now, we can save and launch the scan.</p><p><a href="https://i.imgur.com/1cY5hUx.png" class="popup img-link "><img data-src="https://i.imgur.com/1cY5hUx.png" alt="results" class="lazyload" data-proofer-ignore></a></p><h2 id="creating-a-custom-baseline-based-on-cis"><span class="mr-2">Creating a custom baseline based on CIS</span><a href="#creating-a-custom-baseline-based-on-cis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>it’s important to know, that our server doesn’t have any baseline, it only has all configurations by default. Therefore, the server only has a 84 items passed. However, we can create a custom baseline based on CIS benchmark because an organization can focus on specific items according to the risk that they want to take it. To ilustrate this situation, <strong>imagine that our company only has as a baseline a password policy and only wants to see those configurations:</strong>.</p><ul><li>Account lockout duration<li>Enforce password history<li>Interactive logon: Machine account lockout threshold<li>Maximum password age<li>Minimum password age<li>Minimum password length<li>Password must meet complexity requirement<li>Reset lockout counter after<li>Network security: Force logoff when logon hours expire</ul><p>In this situation, we have to download the CIS bechmark for Windows server 2016 here: https://www.tenable.com/audits/</p><p><a href="https://i.imgur.com/j8fGQHQ.png" class="popup img-link "><img data-src="https://i.imgur.com/j8fGQHQ.png" alt="cis-file" class="lazyload" data-proofer-ignore></a></p><p>after download the file, we can edit with visual studio or any text editor. the CIS benchmark file looks like this:</p><p><a href="https://i.imgur.com/VYVja9f.png" class="popup img-link "><img data-src="https://i.imgur.com/VYVja9f.png" alt="cis-file2" class="lazyload" data-proofer-ignore></a></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>    &lt;custom_item&gt;
      type           : LOCKOUT_POLICY
      description    : "Account lockout duration"
      info           : "Account lockout duration

This security setting determines the number of minutes a locked-out account remains locked out before automatically becoming unlocked. The available range is from 0 minutes through 99,999 minutes. If you set the account lockout duration to 0, the account will be locked out until an administrator explicitly unlocks it.

If an account lockout threshold is defined, the account lockout duration must be greater than or equal to the reset time.

Default: None, because this policy setting only has meaning when an Account lockout threshold is specified."
      solution       : "Policy Path: Account Policies\Account Lockout Policy
Policy Name: Account lockout duration"
      reference      : "800-171|3.1.8,800-53|AC-7a.,CN-L3|8.1.4.1(b),CSCv6|16.7,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
      see_also       : "https://blogs.technet.microsoft.com/secguide/2016/10/17/security-baseline-for-windows-10-v1607-anniversary-edition-and-windows-server-2016/"
      value_type     : TIME_MINUTE
      value_data     : [15..MAX]
      lockout_policy : LOCKOUT_DURATION
    &lt;/custom_item&gt;
</pre></table></code></div></div><p>after modifying the file, we can edit the scan in Nessus and see the new results.</p><p><a href="https://i.imgur.com/8ewTaeA.png" class="popup img-link "><img data-src="https://i.imgur.com/8ewTaeA.png" alt="custom-cis" class="lazyload" data-proofer-ignore></a></p><p><a href="https://i.imgur.com/MfSXTAV.png" class="popup img-link "><img data-src="https://i.imgur.com/MfSXTAV.png" alt="results-custom" class="lazyload" data-proofer-ignore></a></p><p><a href="https://i.imgur.com/Fiz6Fot.png" class="popup img-link "><img data-src="https://i.imgur.com/Fiz6Fot.png" alt="results-custom2" class="lazyload" data-proofer-ignore></a></p><p>it can be seen that the compliance report is according to the items that we want. Furthermore, if those items are configured, it will show in the next scan as a PASSED status.</p><p><a href="https://i.imgur.com/3dOcZhh.png" class="popup img-link "><img data-src="https://i.imgur.com/3dOcZhh.png" alt="remediate" class="lazyload" data-proofer-ignore></a></p><p>if we see the history we see that we have improved the compliance report, remediating some items.</p><ul><li><p>Before: <a href="https://i.imgur.com/s6ScRvj.png" class="popup img-link "><img data-src="https://i.imgur.com/s6ScRvj.png" alt="before" class="lazyload" data-proofer-ignore></a></p><li><p>After <a href="https://i.imgur.com/70DphYe.png" class="popup img-link "><img data-src="https://i.imgur.com/70DphYe.png" alt="after" class="lazyload" data-proofer-ignore></a></p></ul><p>Finally, if there is no budget to purchase a vulnerability tool like Nessus, we can explore open source tools like this: https://github.com/0x6d69636b/windows_hardening. Then, we can create a central repository to save all the outputs and finally trying to create a dashboard with the results.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/blog/categories/security/'>security</a>, <a href='/blog/categories/vulnerability-scan/'>vulnerability scan</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/blog/tags/nessus/" class="post-tag no-text-decoration" >nessus</a> <a href="/blog/tags/cis-compliance/" class="post-tag no-text-decoration" >cis compliance</a> <a href="/blog/tags/vulnerability-scan/" class="post-tag no-text-decoration" >vulnerability scan</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=How%20to%20Configure%20CIS%20Compliance%20Report%20in%20Nessus%20-%20Unf0rG1v3n&url=https%3A%2F%2Fjean0828.github.io%2Fblog%2Fposts%2FConfiguring-CIS-Compliance-Report-in-Nessus%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=How%20to%20Configure%20CIS%20Compliance%20Report%20in%20Nessus%20-%20Unf0rG1v3n&u=https%3A%2F%2Fjean0828.github.io%2Fblog%2Fposts%2FConfiguring-CIS-Compliance-Report-in-Nessus%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fjean0828.github.io%2Fblog%2Fposts%2FConfiguring-CIS-Compliance-Report-in-Nessus%2F&text=How%20to%20Configure%20CIS%20Compliance%20Report%20in%20Nessus%20-%20Unf0rG1v3n" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/posts/LDAP-Monitoring-with-AMA-and-Microsoft-Sentinel/">LDAP Monitoring with AMA and Microsoft Sentinel</a><li><a href="/blog/posts/Deploying-a-Cloud-Environment-for-DevSecops/">Deploying a Cloud Environment for DevSecops</a><li><a href="/blog/posts/Analyzing-Packets-with-Wireshark-and-Python/">Analyzing Packets with Wireshark and Python</a><li><a href="/blog/posts/Administracion-de-cuentas-locales-en-el-Directorio-Activo-con-LAPS/">(ESP) Administracion de cuentas locales en el Directorio Activo con LAPS</a><li><a href="/blog/posts/Monitoring-Powershell-commands-with-Elastic-Stack/">Monitoring Powershell commands with Elastic Stack</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/blog/tags/sentinel/">sentinel</a> <a class="post-tag" href="/blog/tags/siem/">siem</a> <a class="post-tag" href="/blog/tags/active-directory/">active directory</a> <a class="post-tag" href="/blog/tags/windows/">windows</a> <a class="post-tag" href="/blog/tags/azure/">azure</a> <a class="post-tag" href="/blog/tags/devsecops/">devsecops</a> <a class="post-tag" href="/blog/tags/elastic/">elastic</a> <a class="post-tag" href="/blog/tags/google-cloud/">google cloud</a> <a class="post-tag" href="/blog/tags/jenkins/">jenkins</a> <a class="post-tag" href="/blog/tags/kubernetes/">kubernetes</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/posts/Visualizing-Windows-VM-access-in-the-Microsoft-Sentinel-map/"><div class="card-body"> <em class="small" data-ts="1652325600" data-df="ll" > May 12, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Visualizing Windows VM access in the Microsoft Sentinel map</h3><div class="text-muted small"><p> In the previous post we deployed Microsoft Sentinel with the connector to gather data from the Windows VM. Now, we can explore some workbooks to see pre-defined dashboards for example, we can us...</p></div></div></a></div><div class="card"> <a href="/blog/posts/Monitoring-Powershell-commands-with-Elastic-Stack/"><div class="card-body"> <em class="small" data-ts="1653268800" data-df="ll" > May 23, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Monitoring Powershell commands with Elastic Stack</h3><div class="text-muted small"><p> In some cases it’s important to monitor all the powershell commands executed in a windows server because it can help us to alert possible attacks and lateral movements. For that reason, in this pos...</p></div></div></a></div><div class="card"> <a href="/blog/posts/Administracion-de-cuentas-locales-en-el-Directorio-Activo-con-LAPS/"><div class="card-body"> <em class="small" data-ts="1653621600" data-df="ll" > May 27, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(ESP) Administracion de cuentas locales en el Directorio Activo con LAPS</h3><div class="text-muted small"><p> En ambientes empresariales es dificil realizar una administracion adecuada de las cuentas locales. Por ello, Microsoft tiene una herramienta gratuita llamada LAPS para administrar automaticamente l...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/posts/Administracion-de-cuentas-locales-en-el-Directorio-Activo-con-LAPS/" class="btn btn-outline-primary" prompt="Older"><p>(ESP) Administracion de cuentas locales en el Directorio Activo con LAPS</p></a> <a href="/blog/posts/Deploying-Wazuh-in-a-home-lab/" class="btn btn-outline-primary" prompt="Newer"><p>Deploying Wazuh in a home lab</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/blog/tags/sentinel/">sentinel</a> <a class="post-tag" href="/blog/tags/siem/">siem</a> <a class="post-tag" href="/blog/tags/active-directory/">active directory</a> <a class="post-tag" href="/blog/tags/windows/">windows</a> <a class="post-tag" href="/blog/tags/azure/">azure</a> <a class="post-tag" href="/blog/tags/devsecops/">devsecops</a> <a class="post-tag" href="/blog/tags/elastic/">elastic</a> <a class="post-tag" href="/blog/tags/google-cloud/">google cloud</a> <a class="post-tag" href="/blog/tags/jenkins/">jenkins</a> <a class="post-tag" href="/blog/tags/kubernetes/">kubernetes</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/jean0828">Jean Pierre</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/blog/unregister.js"></script>
